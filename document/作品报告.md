# 作品报告

[toc]



## 0 摘要

简要说明创作本作品之动机、功能、特性、创新处、实用性

## 1 作品概述 

官方：建议包括背景分析、相关工作、特色描述及应用前景分析等

### 1.1 背景分析 mzw

​    云存储、云计算的安全性问题，如何实现在第三方平台的机密计算（全文搜索）



​    随着通信技术的发展、传输速度的增加，以及数据文件的不断变大，个人电脑变得越来越难以胜任海量数据的处理。服务器等计算中心由于其强劲的性能备受青睐，外加之数据传输越来越便捷，云存储与云计算等技术正在蓬勃发展，其应用也在变得越来越广。调查显示，越来越多的企业与个人正在频繁地使用云存储服务，例如阿里云、阿里云、amazon、iCloud等等。

​    数据的使用与处理变得更加便捷，但却由此带来安全隐患。用户的个人隐私数据在交付服务方(数据处理方)之后，这些个 人隐私数据的安全性该如何保证。由于数据的处理过程完全在用户不可控的情形下进 行，则即便是个人数据的有关权利被侵犯或者是数据遭到泄露，用户本人也无法及时 全面的了解情况。若这些数据在云端被不法分子获取，用于一些危害用户安全和社会 稳定的行为，则后果更为严重。另一方面，提供服务的开发商面临的问题是:若获取 的用户隐私数据泄露，开发商在法律上是不是要承担一定责任;而隐私数据的处理过 程和处理结果若被篡改，又应当由谁来承担责任？

​	仅仅因为服务器被黑客攻击这一单一原因导致的数据隐私泄露事件就不胜枚举发生。2018年就发生了FACEBOOK三千万用户的隐私数据泄露；圆通快递十亿条运单信息、万豪酒店五亿条开房信息泄露等等等等事件。这些服务器数据的泄露事件触目惊心。

​	数据泄露仅仅是云存储安全问题的其中之一。除了数据泄露之外，云存储与云计算还面临着身份、凭据和访问管理不当，系统漏洞，账户劫持，恶意内部人员，高级持续威胁（APTs）、幽灵（Spectre）、熔断（meltsown）等等威胁。

​	以账户劫持为例，CSA（Canadian Standards Association，加拿大标准协会）的一篇报告指出帐户或服务劫持并不新鲜，但云服务的出现带来了新的威胁。如果攻击者获得了对用户凭证的访问权，他们就可以监视用户活动和交易，操纵数据，返回伪造的信息，并将客户重定向到非法站点。帐户或服务实例可能成为攻击者的新依据。使用窃取的凭证，攻击者可以访问云计算服务的关键部分，从而破坏这些服务的机密性、完整性和可用性。Deep Dive 报告中的一个例子：Dirty Cow 高级持续威胁 (APT) 小组能够通过薄弱的审查或社会工程接管现有帐户，从而获得系统root权限。该报告建议对访问权限实行 “需要知道” 和 “需要访问” 策略，并对帐户接管策略进行社交工程训练。

​	综上所述，针对云服务这一过程，其存在用户数据的隐私与安全性无法得到保障、过程和结果可能存在不一致性（即某一步骤可能遭到篡改）等问题，而这也是我们希望解决的痛点。当然，针对这一问题，业界与学界已有不少解决方案。例如同态加密算法、姚期智院士提出的MPC（安全多方计算）等等。

​	同时，云服务的方向很多，我们着力于基于TEE环境实现一个安全高效的密文空间全文搜索系统。

### 1.2 相关工作现状 mzw

为了实现安全的全文搜索，当下的实现方案和研究进展



​	由前文提到，我们的目标是构建一个安全高效的密文空间全文搜索系统。

​	可搜索加密问题源于文献[1]:假设用户Alice试图将个人文件存放在一个诚实但具有好奇心的外部服务器,以降低本地资源开销.为保护文件隐私,须采用某种加密方式将文件加密后存储.使用传统分组密码,只有密钥拥有者才具备解密能力,意味着Alice在执行基于关键词的查询操作时,需要下载所有已上传的文件,完全解密后再检索,会带来两个问题:1、如果Alice在服务器上已存有大量文件,一一下载会占用大量网络带宽,可能造成服务器堵塞;2、对已下载的所有文件完全解密会占用大量本地计算资源,效率极低。

​	针对这一特殊的问题，业界与学界亦已有不少解决方案。例如可搜索加密算法、同态加密算法、安全多方计算等等。但这些算法或是功能相当受限，或是时间空间的复杂度高到当前的硬件基础无法接受。

​	1.2.1节中将对这些算法一一介绍。

​	1.2.2节中将介绍业界结合TEE的一些应用。

#### 1.2.1 基于传统密码学方案

同态加密、可搜索加密、安全多方计算，突出不足之处

##### 1.2.1.1 同态加密计算

​	同态加密是 Rivest 等人在 1978 年提出的一种加密方案。实现对加密数据的全同 态计算对于云服务拥有者和用户来说，是非常有利用价值的功能。同态加密使得我们 可以直接对密文进行运算，运算得到的结果和明文对应的运算得到的结果再加密是一 致的。在 2009 年，IBM 的学者 Gentry 发明出了第一个全同态方案，提出了一个具有 自举性的同态加密方案可以转换为一个全同态加密方案，该方案可以支持任意深度电 路的计算。从 2009 年到现在，学者们对 Gentry 同态加密算法方案进行了优化并实现 了很多衍生方案。从理论上说，全同态加密算法可以从根本上解决数据第三方委托问 题，这样可以直接将数据交给第三方运算，从而利用云端大规模的计算资源对隐私数 据进行处理。但是全同态加密方案有一些缺点，最重要的就是运算效率太低。虽然国 内外学者提出了一些全同态加密的改进方案，但这些方案的实用性都不足够运用在实 际平台中。Dijk 和 Gentry 等人提出的方案在现实生活的应用中，加密的速度非常慢， 消耗比较大，所以，现在提出的各种全同态加密方案对于隐私保护计算仅仅停留在理论解决阶段，并不能在实际中大规模部署应用。

![image-20210430191902716](../image/image-20210430191902716.png)

<p align="right">	全同态加密算法示意图</p>



​	以下为一定数据量大小在全同态加密算法下生成密钥所需的时间、生成的包的大小与解密所需的时间。

| **Dimension**  | **KeyGen** | **PK** **Size** | **Recryp** |
| -------------- | ---------- | --------------- | ---------- |
| 2048（100KB）  | 40  Sec    | 70MB            | 31  Sec    |
| 8196（400KB）  | 8  Min     | 285MB           | 3  Min     |
| 32768（1.6MB） | 2  Hours   | 2.3GB           | 30  Min    |

​	综上所述，同态加密算法可以用理论密码学确保其的绝对安全，并且可以对数据进行任意操作，具有强大的通用性；但由于其所需的时间与空间的接近于$$10^5$$倍的原有开销，实际的使用价值有限。

##### 1.2.1.2 可搜索加密算法

​	可搜索加密(searchable encryption,简称SE),该技术要求只有合法用户才具备基于关键词检索的能力.随着研究的推进,其应用并不仅限于此:2004年,Boneh提出使用非对称可搜索加密(asymmetric searchable encryption,简称ASE)解决“不可信赖服务器路由”问题[2];最近兴起的云计算[3]将是SE的最佳应用平台,由于服务提供商的不可控性,用户必须应对存储到云端的个人数据可能泄密的威胁,SE提供的加密和密文直接检索功能使服务器无法窃听用户个人数据,但可以根据查询请求返回目标密文文件,这样既保证了用户数据的安全和隐私,又不会过分降低查询效率。

​	可搜索加密中又存在单用户模型、多对一模型、一对多模型和多对多模型，其解决策略也不尽相同，分为对称可搜索加密、非对称可搜索加密等，构造也分为SWP方案[1]、Z-IDX方案[4]和SSE-1方案[6]等等。

​	可搜索加密算法的优点主要在于时间和空间所需的复杂度都较低，以查询为例，仅需O（1）的时间即可完成检索。但其也有不少缺点：

1、执行文件的添加或删除操作需要重新构建索引,时间开销较大。

2、多关键词检索的条件下，需*O*(*n*)通信量,可能造成网络负载过重；且其多关键词检索方案的安全性通常依赖于某种数学难题,所依赖的数学难题的强弱也反映了方案安全性的高低。

3、部分方案（如SSE）由于缺乏对细微文字以及格式错误的容忍，无法进行模糊关键词搜索。

4、许多方案（如SSE）仅支持布尔检索(即,判断某个关键词是否存在于文件中)而不能追踪关键词与文件的相关度.对于查询返回结果,用户必须进行后处理:解密所有返回文件,以获取目标文件。而多用户单服务器模型下的查询结果排序问题至今未解决。

​	综上所述，可搜索加密算法的优点为搜索快速而高效，但是对于云盘类的需要频繁更新文件的应用场景，七每次需要重构索引的时间开销相当之大；且其对多关键词检索、模糊搜索等并没有有很好的支持。

##### 1.2.1.3 安全多方计算

​	安全多方计算最早是由华裔计算机科学家、图灵奖获得者姚启智院士通过百万富翁问题提出的。该问题表述为：两个百万富翁Alice和Bob想知道他们两个谁更富有，但他们都不想让对方知道自己财富的任何信息。在双方都不提供真实财富信息的情况下，如果比较两个人的财富多少，并给出可信证明。

​	安全多方计算技术框架如下图所示：

<img src="../image/image-20210430195024717.png" alt="image-20210430195024717" style="zoom:50%;" />

​	各个MPC参与节点地位相同，可以发起协同计算任务，也可以选择参与其他方发起的计算任务。路由寻址和计算逻辑传输由枢纽节点控制，寻找相关数据同时传输计算逻辑。各个MPC节点根据计算逻辑，在本地数据库完成数据提取、计算，并将输出计算结果路由到指定节点，从而多方节点完成协同计算任务，输出唯一性结果。整个过程各方数据全部在本地，并不提供给其他节点，在保证数据隐私的情况下，将计算结果反馈到整个计算任务系统，从而各方得到正确的数据反馈。

​	著名密码学专家 Goldwasser 曾经说过“在密码学研究领域中，安全多方计算今天所处 的地位正如公钥密码学算法十年前所处的地位，而且它是一个极其重要的工具，它将 成为计算科学中不可替代的一部分。”Goldreich 等人进一步对安全多方计算进行了 系统性研究，并从理论上证明了一般的安全多方计算问题是可解的，提出了安全多方 计算协议的安全性定义与模拟范例。但从计算效率的角度考虑，Goldreich 等人指出，使用通用的计算模型解决具体的安全多方计算问题是不实际的，安全多方计算协议本 身不支持通用的计算模型，针对具体的问题应该研究具体的解决方案，另一方面，安 全多方计算协议本身设计较为复杂，也成为了其大规模推广部署的一个关键瓶颈。

#### 1.2.2 基于可信执行环境（TEE）

阿里工作（为什么阿里做了而我们也在做? 它们还在研究中，侧重点不同balabala）

​	结合可信执行环境（Trust Exectuion Environment,TEE）的应用虽然尚未具规模（受限于额外的硬件开销与开发环境尚未很成熟），但由于其对于安全性、时空开销的较好平衡，许多大厂都已经在这个赛道上开始发力。以阿里云为例，其推出了物联网可信执行环境阿里云Link TEE，为物联网设备提供TEE安全框架和安全应用的全生命周期管理，提供符合Global Platform TEE标准接口的安全、可信执行环境。

​	其架构如下：



![img](https://img.alicdn.com/tfs/TB1Fb8HmeOSBuNjy0FdXXbDnVXa-1192-700.png)

​	根据其官网的介绍，阿里云Link TEE（Trusted Execution Environment）提供不同安全等级的可信保护，支持基于ARM Trustzone或T-Head的安全扩展技术提供硬件级别的可信根，也提供软件级别的保护方案。Link TEE产品可以为多个行业的设备提供安全应用场景，广泛应用于指纹识别、身份认证、电子支付、TEE-SIM、智能锁等安全应用。Link TEE提供安全基础架构和可信运行环境，构建安全增强服务。

​	其现已推出三款物联网TEE芯片：TEE Pro、TEE Cap与TEE Air，分别支持不同裁剪大小的系统，从桌面端的Linux、Andriod、AliOS到嵌入式设备的RT OS，一应俱全。

​	综上，阿里云也看到了TEE对于安全性、时空复杂度的高效平衡，正在大力推动相关的开发。我们的项目与其对比，我们着力于基于TEE的可搜索云服务的开发，并且使用的TEE环境为主机端的intel SGX；而阿里着力于打造IoT设备的安全扩展技术，并且使用的TEE环境是ARM的TrustZONE。

### 1.3 特色描述 lzh

Tantivy的移植和性能改善、通信协议、客户端服务端的设计、性能测试

### 1.4 应用前景分析 mzw

全文搜索的应用场景

政府、医疗、邮件……

## 2 作品设计与实现

官方：建议包括系统方案、实现原理、硬件框图、软件流程、功能、指标等

### 2.1 设计概述 lzh

#### 2.1.1 设计方案

#### 2.1.2 系统功能

### 2.2 技术原理

#### 2.2.1 TEE与SGX技术 mzw

TEE、SGX技术介绍，Rust SGX SDK（选择Rust的理由）

#### 2.2.2 文本搜索引擎Tantivy  TM

Tantivy索引组织方式，打分算法BM25等等

#### 2.2.3 其它技术 TM

密码学算法、HTTPS

### 2.3 系统实现

#### 2.3.1 Tantivy的移植与性能改善 TM

#### 2.3.2 通信协议设计 lzh

证书颁发+认证+会话密钥协商

#### 2.3.3 服务端实现 lzh

#### 2.3.4 客户端实现 lzh

## 3 作品测试与分析

官方：建议包括测试方案、测试环境搭建、测试设备、测试数据、结果分析等

### 3.1 测试环境 clf

客户端、服务端

### 3.2 功能测试 clf

上传测试集，验证各个功能，搜索、删除、下载等等

### 3.3 性能测试 clf

比较原生Tantivy、我们的系统、Lucene，进行压力测试？

### 3.4 安全性分析 lzh

我们系统的安全性能保障 

SGX面临的攻击

## 4 创新性说明

## 5 总结

### 5.1 工作总结

### 5.2 未来展望

## 6 参考文献

| [1]  | Song XD, Wagner D, Perrig A. Practical techniques for searches on encrypted data. In: Proc. of the IEEE Symp. on Security and Privacy. [IEEE Press, 2000. 44-55 ](http://dx.doi.org/10.1109/SECPRI.2000.848445). |
| ---- | ------------------------------------------------------------ |
| [2]  | Boneh D, Di Crescenzo G, Ostrovsky R, Persiano G. Public key encryption with keyword search. In: Camenisch LJ, Cachin C, eds. Proc. of the Advances in Cryptology—EUROCRYPT 2004. [LNCS 3027, Berlin: Springer-Verlag, 2004. 506-522 ](http://dx.doi.org/10.1007/978-3-540-24676-3_30). |
| [3]  | Feng DG, Zhang M, Zhang Y, Xu Z. Study on cloud computing security. Ruan Jian Xue Bao/Journal of Softwase, 2011,22(1): 71-83 (in Chinese with English abstract). [http://www.jos.org.cn/1000-9825/3958.htm](http://dx.doi.org/10.3724/SP.J.1001.2011.03958) |
| [4]  | LI Jing-Wei, JIA Chun-Fu, LIU Zhe-Li, LI Jin, LI Min. Survey on the Searchable Encryption[J]. Ruan Jian Xue Bao/ Journal of Software, 2015, 26(1): 109-128.http://www.jos.org.cn/1000-9825/4700.html |
|      |                                                              |
| [6]  | Curtmola R, Garay J, Kamara S, Ostrovsky R. Searchable symmetric encryption: Improved definitions and efficient constructions. In: Proc. of the 13th ACM Conf. on Computer and Communications Security (CCS 2006). New York: ACM Press, 2006. 79-88. |
|      |                                                              |

